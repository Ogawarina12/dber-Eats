<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dber Eats</title>
    <style>
        :root { --primary: #06C167; --bg: #f6f6f6; --dber-black: #000000; --dber-blue: #2D6595; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif; background: var(--bg); margin: 0; padding: 0; }
        
        /* å…±é€šè¨­å®š */
        .hidden { display: none !important; }
        .fade-out { opacity: 0; transition: opacity 0.5s ease; }
        
        /* 1. ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ç”»é¢ï¼ˆèµ·å‹•ç”»é¢ï¼‰ */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--dber-black);
            display: flex; justify-content: center; align-items: center;
            z-index: 9999;
        }
        #splash-logo {
            width: 150px; /* ç”»åƒã®ã‚µã‚¤ã‚ºèª¿æ•´ */
            height: auto;
            border-radius: 20px;
        }

        /* 2. ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ */
        #login-screen {
            height: 100vh;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 20px;
            background: white;
            box-sizing: border-box;
        }
        .login-logo-text { font-size: 2rem; font-weight: bold; margin-bottom: 40px; }
        .login-logo-text span { color: var(--dber-blue); }
        
        .auth-input {
            width: 100%; max-width: 300px; padding: 15px;
            font-size: 1.1rem; border: 1px solid #ddd; border-radius: 8px;
            margin-bottom: 15px; box-sizing: border-box; background: #f9f9f9;
        }
        .login-btn {
            width: 100%; max-width: 300px; padding: 15px;
            background: var(--dber-black); color: white;
            border: none; border-radius: 8px; font-size: 1rem; font-weight: bold;
            cursor: pointer; margin-bottom: 20px;
        }
        .bio-btn {
            background: white; color: #333; border: 1px solid #ddd;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }

        /* 3. ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªç”»é¢ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ */
        #main-app { padding-bottom: 100px; }
        header { background: white; padding: 15px; position: sticky; top: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05); z-index: 10; display: flex; justify-content: space-between; align-items: center; }
        .header-logo { font-weight: bold; font-size: 1.2rem; }
        .user-status { font-size: 0.8rem; color: #666; background: #eee; padding: 2px 8px; border-radius: 10px; }

        .section { background: white; margin: 15px; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.03); }
        h2 { font-size: 1rem; margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        /* ãƒ•ã‚©ãƒ¼ãƒ éƒ¨å“ */
        select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; background: white; }
        .radio-group label { display: block; padding: 10px 0; border-bottom: 1px solid #f0f0f0; cursor: pointer; }
        .radio-group label:last-child { border-bottom: none; }

        /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒªã‚¹ãƒˆ */
        .menu-item { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding: 15px 0; }
        .item-info h3 { margin: 0 0 5px 0; font-size: 1rem; }
        .add-btn { background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 20px; font-weight: bold; cursor: pointer; }

        /* ãƒ•ãƒƒã‚¿ãƒ¼ã‚«ãƒ¼ãƒˆ */
        .cart-bar { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px; border-top: 1px solid #ddd; box-sizing: border-box; text-align: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .order-btn { background: var(--primary); color: white; border: none; padding: 15px 0; width: 95%; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; }
        .order-btn:disabled { background: #ccc; }
    </style>
</head>
<body>

<div id="splash-screen">
    <img src="image_bc999d.png" id="splash-logo" alt="dber Eats Logo">
</div>

<div id="login-screen" class="hidden">
    <div class="login-logo-text">dber <span>Eats</span></div>
    
    <input type="text" id="login-student-id" class="auth-input" placeholder="å­¦ç±ç•ªå· (ä¾‹:26XX999)">
    <button class="login-btn" onclick="handleLogin()">å§‹ã‚ã‚‹</button>
    
    <div style="margin: 10px; color: #999;">ã¾ãŸã¯</div>
    
    <button class="login-btn bio-btn" onclick="mockBiometricAuth()">
        <span style="font-size: 1.2rem;">ğŸ‘†</span> æŒ‡ç´‹/é¡”èªè¨¼ã§ãƒ­ã‚°ã‚¤ãƒ³
    </button>
</div>

<div id="main-app" class="hidden">
    <header>
        <div class="header-logo">dber <span style="color:var(--dber-blue)">Eats</span> ğŸ±</div>
        <div id="header-user-id" class="user-status">æœªãƒ­ã‚°ã‚¤ãƒ³</div>
    </header>

    <div class="section">
        <h2>ğŸ“ å—ã‘å–ã‚Šå ´æ‰€</h2>
        <select id="location-select">
            <option value="1å·é¤¨6éšãƒ©ã‚¦ãƒ³ã‚¸">1å·é¤¨6éšãƒ©ã‚¦ãƒ³ã‚¸</option>
            <option value="3å·é¤¨1éš">3å·é¤¨1éš</option>
            <option value="5301æ•™å®¤">5301æ•™å®¤</option>
            <option value="2å·é¤¨-ç·åˆãƒ¡ãƒ‡ã‚£ã‚¢ã‚»ãƒ³ã‚¿ãƒ¼å‰">2å·é¤¨-ç·åˆãƒ¡ãƒ‡ã‚£ã‚¢ã‚»ãƒ³ã‚¿ãƒ¼å‰</option>
            <option value="éƒ¨å®¤æ£Ÿ-1F">éƒ¨å®¤æ£Ÿ-1F</option>
        </select>
    </div>

    <div class="section">
        <h2>ğŸ” ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠ</h2>
        <div id="menu-list"></div>
    </div>

    <div class="section">
        <h2>ğŸ’³ æ±ºæ¸ˆæ–¹æ³•</h2>
        <div class="radio-group">
            <label><input type="radio" name="payment" value="ç¾é‡‘" checked> ğŸ’µ ç¾é‡‘ï¼ˆå—å–æ™‚æ‰•ã„ï¼‰</label>
            <label><input type="radio" name="payment" value="PayPay"> ğŸ…¿ï¸ PayPay</label>
            <label><input type="radio" name="payment" value="ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰"> ğŸ’³ ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰</label>
        </div>
    </div>

    <div class="cart-bar">
        <button id="order-btn" class="order-btn" onclick="submitOrder()" disabled>æ³¨æ–‡ã™ã‚‹ (Â¥0)</button>
    </div>
</div>

<script>
    // --- å¤‰æ•°å®šç¾© ---
    let currentStudentId = "";
    let cart = [];
    const menuData = [
        { id: 1, name: "æ—¥æ›¿ã‚ã‚ŠAå¼å½“ (ãƒãƒ³ãƒãƒ¼ã‚°)", price: 500 },
        { id: 2, name: "ã‚«ãƒ„ã‚«ãƒ¬ãƒ¼", price: 480 },
        { id: 3, name: "å”æšã’æ£’", price: 150 },
        { id: 4, name: "å­¦é£Ÿã®å‘³å™Œæ±", price: 50 },
        { id: 5, name: "ãŠèŒ¶ (500ml)", price: 120 }
    ];

    // --- 1. ã‚¢ãƒ—ãƒªèµ·å‹•å‡¦ç† ---
    window.onload = () => {
        // 2ç§’å¾Œã«ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚’æ¶ˆã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‚’è¡¨ç¤º
        setTimeout(() => {
            const splash = document.getElementById('splash-screen');
            splash.classList.add('fade-out');
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã«è¦ç´ ã‚’å®Œå…¨ã«æ¶ˆã™
            setTimeout(() => {
                splash.classList.add('hidden');
                document.getElementById('login-screen').classList.remove('hidden');
            }, 500);
        }, 2000); // 2000ms = 2ç§’å¾…æ©Ÿ

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”Ÿæˆ
        renderMenu();
    };

    // --- 2. èªè¨¼é–¢é€£å‡¦ç† ---
    function handleLogin() {
        const inputId = document.getElementById('login-student-id').value;
        if (inputId.length < 4) {
            alert("æ­£ã—ã„å­¦ç±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            return;
        }
        completeLogin(inputId);
    }

    function mockBiometricAuth() {
        const btn = document.querySelector('.bio-btn');
        const originalText = btn.innerHTML;
        btn.innerHTML = "â³ èªè¨¼ä¸­...";
        
        setTimeout(() => {
            // æ“¬ä¼¼çš„ã«èªè¨¼æˆåŠŸ
            completeLogin("2026999 (ç”Ÿä½“èªè¨¼æ¸ˆ)");
        }, 1000);
    }

    function completeLogin(id) {
        currentStudentId = id;
        document.getElementById('header-user-id').innerText = `ID: ${currentStudentId}`;
        
        // ç”»é¢é·ç§»
        document.getElementById('login-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
    }

    // --- 3. æ³¨æ–‡é–¢é€£å‡¦ç† ---
    function renderMenu() {
        const list = document.getElementById('menu-list');
        menuData.forEach(item => {
            list.innerHTML += `
                <div class="menu-item">
                    <div class="item-info">
                        <h3>${item.name}</h3>
                        <div>Â¥${item.price}</div>
                    </div>
                    <button class="add-btn" onclick="addToCart('${item.name}', ${item.price})">è¿½åŠ </button>
                </div>`;
        });
    }

    function addToCart(name, price) {
        cart.push({ name, price });
        updateButton();
    }

    function updateButton() {
        const total = cart.reduce((sum, item) => sum + item.price, 0);
        const btn = document.getElementById('order-btn');
        btn.innerText = `æ³¨æ–‡ã™ã‚‹ (Â¥${total})`;
        btn.disabled = cart.length === 0;
    }

    function submitOrder() {
        const location = document.getElementById('location-select').value;
        const payment = document.querySelector('input[name="payment"]:checked').value;

        if (!location) return alert("ğŸ“ é…é”å ´æ‰€ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼");

        // åº—èˆ—ç®¡ç†å´ã¸é€ã‚‹ãƒ‡ãƒ¼ã‚¿
        const orderData = {
            id: Date.now(),
            time: new Date().toLocaleTimeString(),
            location: location,
            studentId: currentStudentId, // ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§å–å¾—ã—ãŸIDã‚’ä½¿ç”¨
            items: cart.map(c => c.name).join(", "),
            total: cart.reduce((sum, item) => sum + item.price, 0),
            payment: payment,
            status: "èª¿ç†å¾…ã¡"
        };

        // LocalStorageã«ä¿å­˜ï¼ˆadmin.htmlã¨é€£æºï¼‰
        const currentOrders = JSON.parse(localStorage.getItem('dber_orders') || '[]');
        currentOrders.push(orderData);
        localStorage.setItem('dber_orders', JSON.stringify(currentOrders));

        alert("âœ… æ³¨æ–‡å®Œäº†ï¼\nå­¦é£Ÿã§èª¿ç†ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚");
        
        // ã‚«ãƒ¼ãƒˆãƒªã‚»ãƒƒãƒˆ
        cart = [];
        updateButton();
        document.getElementById('location-select').value = "";
    }
</script>
</body>
</html>